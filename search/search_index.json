{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\u00b5URU Documentation","text":"<p>The Micro User Registration Utility</p>"},{"location":"#what-is-uru","title":"What is \u00b5URU","text":"<p>\u00b5URU is a PBX solution based on Asterisk<sup>1</sup>. \u00b5URU focuses on user self-registration to allow users to create their own extension and register various kinds of phones to the exchange.</p> <p>The systems is primarly intended for use at small events or community locations (like hackspaces) where people want to bring and use their own phones. \u00b5URU is designed to be easily extendable and has a very straight-forward deployment process using docker-compose.</p>"},{"location":"#feature-overview","title":"Feature Overview","text":"<ul> <li>Pluggable Phone-Flavor system, currently supporting<ul> <li>Basic SIP extensions</li> <li>Innovaphone IP241, IP200A, IP112</li> <li>Mitel DECT OMM integration</li> <li>Grandstream WP810 WiFi Phones</li> <li>SNOM 300</li> <li>Dummy extensions</li> <li>IoT extensions</li> </ul> </li> <li>Callgroups</li> <li>Conferences</li> <li>Federation between \u00b5URU instances</li> <li>WebSIP to initiate calls directly from the browser</li> <li>Originate calls via physical phones from the browser</li> <li>LDAP Phonebook</li> <li>Rendering of Markdown for (Help-)Pages</li> <li>Managing of images, audio files and other media</li> <li>Prometheus HTTP Service-Discovery (currently only for Innovaphones)</li> <li>Super-Simplified deployment of the whole PBX by using docker compose</li> </ul>"},{"location":"#example-workflow","title":"Example Workflow","text":"<p>If a user has brought a telephone with them and wants to register it on the system, the workflow is roughly as follows:</p> <ol> <li>The user registers an account</li> <li>The user creates a new extension, for which the following information is required<ul> <li>Type of telephone (e.g., SIP or DECT)</li> <li>Name of the extension</li> <li>Desired telephone number</li> <li>Any additional information depending on the type of telephone</li> </ul> </li> </ol> <p>Once the entries have been saved, the corresponding extension is created and the phone can be registered. For example, the SIP access data can be entered for a softphone, or a DECT phone can be registered to a DECT antenna and automatically linked by calling a registration token.</p> <p>The \u00b5URU supports a growing number of phone types. You can find out exactly how these can be integrated and registered in the phone documentation.</p> <ol> <li> <p>Asterisk: Open source private branch exchange software\u00a0\u21a9</p> </li> </ol>"},{"location":"configuration/","title":"Configuration","text":"<p>uURU is configured via environment variables or an .env file. This should give you an overview about the supported config keys.</p>"},{"location":"configuration/#default-credentials","title":"Default credentials","text":"<p>The credentials for the first created account are configured by</p> Key Description Default UURU_DEFAULT_ROOT_USER Username root UURU_DEFAULT_ROOT_PASSWORD Password rootpasswd"},{"location":"configuration/#security","title":"Security","text":"Key Description Default UURU_SECRET_KEY Secret key used to sign session tokens random (32 chars) UURU_ACCESS_TOKEN_EXPIRE_MINUTES Minutes until a login expires 8 days (11520) UURU_BACKEND_CORS_ORIGINS A list of allowed CORS origins <code>[]</code>"},{"location":"configuration/#http-routing","title":"HTTP routing","text":"<p>Warning</p> <p>Do not change those values, currently uURU contains some hardcoded links which will break otherwise!</p> Key Description Default UURU_WEB_PREFIX Prefix after <code>/</code> for web routes empty UURU_API_V1_STR Prefix after <code>/</code> for api routes /api/v1 UURU_TELEPHONING_PREFIX Prefix after <code>/</code> for telephoning routes /telephoning"},{"location":"configuration/#network","title":"Network","text":"Key Description Default UURU_WEB_HOST Hostname / ip + port of the web host 127.0.0.1:8000 UURU_ASTERISK_HOST Hostname / ip + port of the asterisk 127.0.0.1"},{"location":"configuration/#federation","title":"Federation","text":"Key Description Default UURU_FEDERATION_IAX2_HOST The hostname or ip-address of your asterisk server 127.0.0.1 UURU_FEDERATION_UURU_HOST The web-address of your \u00b5URU instance including protocol http://127.0.0.1:8000"},{"location":"configuration/#application-database","title":"Application Database","text":"Key Description Default UURU_DATABASE_TYPE Type of database for the application (\"mysql\" or \"postgres\") postgres UURU_DATABASE_SERVER Host of the application database UURU_DATABASE_PORT Port for the application database 5432 UURU_DATABASE_USER User for the application database UURU_DATABASE_PASSWORD Password for the application database UURU_DATABASE_DB Database for the application database"},{"location":"configuration/#asterisk-database","title":"Asterisk Database","text":"<p>The database must be a mariadb / mysql db</p> Key Description Default UURU_ASTERISK_DATABASE_SERVER Host of the asterisk database UURU_ASTERISK_DATABASE_PORT Port for the asterisk database 3306 UURU_ASTERISK_DATABASE_USER User for the asterisk database UURU_ASTERISK_DATABASE_PASSWORD Password for the asterisk database UURU_ASTERISK_DATABASE_DB Database for the asterisk database"},{"location":"configuration/#ldap","title":"LDAP","text":"Key Description Default UURU_LDAP_SERVER LDAP server connection string ldap://localhost:389 UURU_LDAP_BASE_DN Base DN of the ldap server dc=uuru UURU_LDAP_USER Admin user of the ldap server cn=admin,dc=uuru UURU_LDAP_PASSWORD Password of the admin user UURU_LDAP_PUBLIC_HOST IP or Hostname of the LDAP server 127.0.0.1 UURU_LDAP_PUBLIC_BIND_USER User for public connections cn=public,dc=uuru UURU_LDAP_PUBLIC_BIND_PASSWORD Password for public connections public"},{"location":"configuration/#application-behavior","title":"Application Behavior","text":"Key Description Default UURU_LOGLEVEL One of CRITICAL, FATAL, ERROR, WARNING, INFO, DEBUG INFO UURU_LIFESPAN_DROP_DB (For dev!) drop the database after application shutdown False UURU_LEGACY_FRONTEND Enable legacy UI False UURU_LIMIT_REGISTRATION Limit registrations by requiring an invite code to register False"},{"location":"configuration/#telephoning","title":"Telephoning","text":"Key Description Default UURU_EXTENSION_DIGITS Required extension number length 4 UURU_EXTENSION_PASSWORD_LENGTH Length of SIP password 20 UURU_EXTENSION_PASSWORD_CHARS Charset from which the password is generated digits (0-9) UURU_EXTENSION_TOKEN_PREFIX Prefix for generated token 01990 UURU_EXTENSION_TOKEN_LENGTH Number of digits after the prefix 8 UURU_RESERVED_EXTENSIONS List of reserved extensions, e.G. [1234, [1000, 2000]] [] UURU_RESERVED_NAME_PREFIXES List of prefixes which normal users may not use for extension names [] UURU_ALL_EXTENSION_TYPES_PUBLIC May normal users create extension with all phone types False UURU_ENABLED_PHONE_FLAVORS A list of enabled phone flavors [\"sip\"]"},{"location":"configuration/#site","title":"Site","text":"Key Description Default UURU_SITE_NAME Name of your uURU setup \"Default\" UURU_SITE_LAT Optional latitude of your location, used for map 0 UURU_SITE_LON Optional longitude of your location, used for map 0"},{"location":"configuration/#pages","title":"Pages","text":"Key Description Default UURU_ENABLE_PAGES True / False True UURU_PAGES_TITLE Title of the Pages dropdown in Navbar Pages"},{"location":"configuration/#websip","title":"WebSIP","text":"<p>Note</p> <p>The <code>UURU_WEBSIP_EXTENSION_RANGE</code> should be reserved via the <code>UURU_RESERVED_EXTENSIONS</code> key.</p> Key Description Default UURU_ENABLE_WEBSIP Enable websip True UURU_WEBSIP_PUBLIC If true you don't need an account to use websip True UURU_WEBSIP_WS_HOST External url where the asterisk websocket is reachable ws://127.0.0.1:8088/ws UURU_WEBSIP_EXTENSION_RANGE Tuple of start and end of the range [9900, 9999]"},{"location":"configuration/#media","title":"Media","text":"Key Description Default UURU_MEDIA_PATH Path to a directory where media files should be stored ./uploads/ UURU_MEDIA_MAX_SIZE_USER Maximum amount of bytes a user might upload 2097152 (2 MiB) UURU_MEDIA_LIMIT_SIZE_ADMIN Apply the limit also for admin users 0 UURU_MEDIA_ALLOW_RAW Allow upload of raw files 0 UURU_MEDIA_IMAGE_STORAGE_FORMAT Format in which images should be stored on disk png UURU_MEDIA_AUDIO_STORAGE_FORMAT Format in which audio files should be stored on disk mp3"},{"location":"configuration/#asterisk-manager-interface","title":"Asterisk Manager Interface","text":"<p>Info</p> <p>Because the <code>asterisk</code> container is exposed via <code>--network=host</code> we have to bind the AMI interface to a specific (non 127.0.0.0/8) ip. We assume that your docker installation ships with <code>docker0</code> on <code>172.17.0.1</code> - change to your setup if needed.</p> <p>Danger</p> <p>By default all other containers/processes on your machine can talk via <code>AMI</code> to the <code>asterisk</code>. We assume a trusted environment. Please generate a secure <code>UURU_ASTERISK_AMI_PASS</code> for production setups.</p> Key Description Default UURU_ASTERISK_AMI_USER Username for the asterisk manager interface uuru_ami_user UURU_ASTERISK_AMI_PASS Secret for the asterisk manager interface uuru_ami_secret UURU_ASTERISK_AMI_ADDR Host of the asterisk manager interface 172.17.0.1 (Docker bridge) UURU_ASTERSIK_AMI_PORT Port of the asterisk manager interface 5038"},{"location":"getting-started/","title":"Installation Instructions","text":"<p>\u00b5URU is published as a docker image and can be installed using <code>docker compose</code>. The git repo also contains two docker compose yaml files (<code>docker-compose.yml</code> and <code>docker-compose-base.yml</code>) which you can use as a starting point.</p>"},{"location":"getting-started/#setup-instructions","title":"Setup Instructions","text":""},{"location":"getting-started/#1-clone-the-repo","title":"1. Clone the repo","text":"<pre><code>git clone https://github.com/olell/uuru\n</code></pre>"},{"location":"getting-started/#2-prepare-the-setup","title":"2. Prepare the setup","text":"<p>The git repo contains a file called <code>.env.sample</code>, copy this file and edit the pre-defined configuration flags. Take a looks at the configuration docs to see which options are available.</p> <pre><code>cp -av .env.sample .env\n# now edit the .env file\n</code></pre> <p>Info</p> <p>Required are at least the following flags</p> <ul> <li><code>UURU_WEB_HOST = &lt;host_ip&gt;&lt;:port&gt;</code></li> <li><code>UURU_ASTERISK_HOST = &lt;host_ip&gt;</code></li> <li><code>UURU_SECRET_KEY = &lt;some secret key&gt;</code></li> </ul> <p>Warning</p> <p>In production you must configure the LDAP credentials in your configuration and in the <code>docker-compose-base.yml</code> to something secure. The LDAP server will be exposed to the public!</p>"},{"location":"getting-started/#3-start-the-system","title":"3. Start the system","text":"<pre><code>docker compose up\n</code></pre> <p>Note</p> <p>At the first start this might take a while since the asterisk container populates the database and does some other housekeeping. If not changed the following ports are now open:</p> <ul> <li><code>0.0.0.0:8000</code> \u00b5URU</li> <li><code>0.0.0.0:389</code> LDAP</li> <li><code>0.0.0.0:8080</code> Asterisk HTTP</li> <li><code>0.0.0.0:5060</code> SIP</li> </ul>"},{"location":"getting-started/#considerations-for-production","title":"Considerations for production","text":"<p>In production you should probably use a reverse-proxy like traefik to deploy the system with HTTPS and a valid certificate. An example of how to do that will follow. Some features (WebSIP) don't work without HTTPS.</p> <p>Also you probably need control over the DHCP server in the network the \u00b5URU is deployed since some VoIP phones require special DHCP options to get their autoprovisioning information.</p>"},{"location":"phone-flavors/","title":"Implement custom phone flavors","text":"<p>\u00b5URU has a pluggable phone flavor system which can be used to implement autoprovisioning or other functions for custom phone types.</p> <p>Phone flavor classes are located in <code>/app/telephoning/phonetypes</code> and should be called <code>{phone_flavor}.py</code>. In those file you must implement a class which inherits <code>PhoneFlavor</code> or any other class inheriting <code>PhoneFlavor</code>.</p> <p>The implemented classes are automatically discovered and enabled if the <code>{phone_flavor}</code> is enabled in the configuration.</p> <p>You can take a look at the <code>/app/telephoning/flavor.py</code> which contains the base class to get more information about how to implement a new phone flavor.</p>"},{"location":"phone-flavors/#how-does-it-work","title":"How does it work?","text":"<p>At application startup all classes inheriting <code>PhoneFlavor</code> are searched and checked if enabled. For enabled phone flavors then an instance will be created and stored. There will be exactly one instance of every enabled phone flavor call at every time.</p> <p>Then a router is created which is given to the class to implement custom http routes. At last the job function of the flavor is called a first time to check if it raises an <code>NotImplementedError</code>, if it does not, the job is scheduled with the defined <code>JOB_INTERVAL</code> interval.</p>"},{"location":"phone-flavors/#how-to-implement","title":"How to implement?","text":"<p>Your class should be called like the phone type or brand your implementing features for. The class must inherit <code>PhoneType</code> or another already existing flavor. If you want to use an SIP-Account within your flavor you should inherit your flavor from the <code>SIP</code> flavor which  can be imported <code>from app.telephoning.phonetypes.sip import SIP</code></p> <pre><code>class ExamplePhone(SIP):\n    ...\n</code></pre> <p>you can implement a constructor if you want to.</p> <p>now your class can implement a variety of fields and functions to define its behavor:</p> <pre><code># A list of strings which are used to identify a phone type, those strings\n# are also used to display the user a dropdown selection when creating a new\n# extension\nPHONE_TYPES: list[str] = []\n\n# PhoneFlavors are ordered by this value before displayed to the user, the\n# higher the more on top\nDISPLAY_INDEX: int = 0\n\n# A pydantic model which describes which fields need to be configured by\n# the user when creating a new extension with this phone type\nEXTRA_FIELDS: BaseModel | None = None\n\n# Special types may only be created by admin users, this behavior\n# can be overwritten by configuring ALL_EXTENSION_TYPES_PUBLIC as true\nIS_SPECIAL: bool = False\n\n# Job interval in seconds\nJOB_INTERVAL: int = 60\n\n# When extensions are created the asterisk phonetype is configured based\n# on this value. If its a string, the value is applied for all phone types\n# in this flavor class. If it is a dict, it has to configure values for\n# all phone types from this class.\n# Supported codecs: \"g722\", \"alaw\", \"ulaw\", \"g726\", \"gsm\", \"lpc10\"\nSUPPORTED_CODEC: CODEC | dict[str, CODEC] = \"g722\"\n\n# This limits the maximum amount of characters for the extension name\nMAX_EXTENSION_NAME_CHARS = 20\n\n# This dict defines which media is required (or optional) for this phonetype\n# take a look at the features/media documentation for more information.\nMEDIA: dict[str, MediaDescriptor] = {}\n</code></pre> <p>And you can override some methods:</p> <p>Note</p> <p>If you inherit the SIP flavor for your phone, you must call the super method if you want to override the <code>on_extension_xyz</code> methods because thats the place where the SIP account is created.</p> <p>Like this: <code>super().on_extension_update(session, asterisk_session, user, extension)</code></p> <pre><code>def on_extension_create(\n    self,\n    session: Session,\n    asterisk_session: Session,\n    user: \"User\",\n    extension: \"Extension\",\n):\n    \"\"\"\n    This function is called after the user created the extension.\n    \"\"\"\n\ndef on_extension_update(\n    self,\n    session: Session,\n    asterisk_session: Session,\n    user: \"User\",\n    extension: \"Extension\",\n):\n    \"\"\"\n    This function is called on any change to the extension.\n    \"\"\"\n\ndef on_extension_delete(\n    self,\n    session: Session,\n    asterisk_session: Session,\n    user: \"User\",\n    extension: \"Extension\",\n):\n    \"\"\"\n    This function is called before the extension gets deleted.\n    \"\"\"\n\ndef generate_routes(self, router: APIRouter):\n    \"\"\"\n    This method is called on application startup, here you can create routes\n    using the standard FastAPI router interfaces.\n\n    Routes from the router are prefixed with\n    `/{settings.TELEPHONING_PREFIX}/{NAME OF THIS CLASS IN LOWERCASE}/`\n\n    To obtain access to the Database Session / Asterisk DB Session use the\n    dependencies from `app.core.db`\n\n    Example for a route, created inside this function:\n    ```\n    @router.post(\"/\")\n    def do_something():\n        pass\n    ```\n    \"\"\"\n\ndef job(self):\n    \"\"\"\n    This function may implement a job which runs regulary in the app\n    background. The job is executed once on application start.\n\n    If it raises an NotImplementedError it will not be scheduled.\n    \"\"\"\n\ndef get_codec(self, extension: \"Extension | None\"):\n    \"\"\"\n    This function can modify how the codec for the SIP account is\n    determined, normally you don't need to override it.\n    \"\"\"\n</code></pre>"},{"location":"features/federation/","title":"Instance Federation","text":"<p>\u00b5URU supports federation between instances using asterisks IAX2 protocol and some inter-instance communication between \u00b5URU instances.</p>"},{"location":"features/federation/#setup-peering-with-another-instance","title":"Setup peering with another instance","text":"<p>To setup a peering connection with another instance first of all both instances need to have a peer-to-peer network connection. If the two instances are not in the same physical network, you may want to use a wireguard tunnel or something similar, but thats up to you since it currently is out of scope for \u00b5URU.</p> <p>After setting up a network connection you can navigate to <code>Admin -&gt; Federation</code> in the webinterface. Here you can see a list of peers and outgoing/incoming peering requests. To create a new peering requests with an other instace click the little plus-sign on the <code>Outgoing Peering Requests</code> heading and enter a name for the peering (the same name will be shown on the partner instance). The host must be the web-address including protocol and if necessary port.</p> <p>After sending your peering requests the other instance will see the request and may now accept or decline the peering request. If you accept a peering request all you have to do is to enter a prefix for your side.</p> <p>To tear down the peering you can simply click the trash icon on the list of peers.</p>"},{"location":"features/federation/#configuration","title":"Configuration","text":"<p>You have to set two configuration keys to setup peering:</p>"},{"location":"features/federation/#configuration_1","title":"Configuration","text":"Key Description UURU_FEDERATION_IAX2_HOST The hostname or ip-address of your asterisk server UURU_FEDERATION_UURU_HOST The web-address of your \u00b5URU instance including protocol (and if necessary port) <p>The addresses for those config keys may differ from the web host / asterisk address you've already configured. The reason for this is that you can use different networks for peering and your telephony network (for example if you build your peering using wireguard tunnels).</p>"},{"location":"features/federation/#technical-details","title":"Technical details","text":"<p>This is a step-by-step flow of what happens when setting up a peering:</p> <ol> <li>Instance A -&gt; Send peering request to partner instance</li> <li>The outgoing request on your side is stored in the database</li> <li>On the other side a incoming peering request is created, using an ID,      the peering name, your \u00b5URU web and asterisk address, your extension      length and a secret</li> <li>Instance B -&gt; Receive peering request</li> <li>The incoming data is stored as an incoming peering request in the database</li> <li>Instance B -&gt; Admin accepts request</li> <li>The incoming peering request is deleted and a IAX2 friend and dialplan entry      in the asterisk database is created. The peer is also stored in the \u00b5URU      database</li> <li>The other side gets notified that you've accepted the request</li> <li>Instance A -&gt; Accept notification receive</li> <li>Once Instance B accepted the request the outgoing request is deleted      from the database and a IAX2 friend dialplan entry are stored in the      asterisk database. The peer is stored in the \u00b5URU database.</li> <li>Now that Instance A and B have IAX2 friends created for each other you can    call each other using the selected prefix</li> </ol>"},{"location":"features/media/","title":"Media Management","text":"<p>\u00b5URU has a media management feature where users can upload media and use the uploaded media for various purposes (for example as a telephone background image).</p>"},{"location":"features/media/#overview","title":"Overview","text":"<p>\u00b5URU supports three kinds of media: <code>Audio</code>, <code>Image</code> and <code>Raw</code>. You can create and delete your own (or if you're an admin all) media files in the media tab.</p> <p>Media is stored at the configured <code>UURU_MEDIA_PATH</code> directory which must exist before application startup. All uploaded media is converted to a default storage format directly after it is uploaded and stored in this format.</p> <p>The phone flavor class defines how media will be used and in which format it is required for the phone. When media is assigned to a extension and the assigned media is requested it gets automatically converted to the specified output type of the phoneflavor.</p>"},{"location":"features/media/#implementation-in-phone-flavor","title":"Implementation in Phone Flavor","text":"<p>To use media files a phoneflavor can define a dictionary with information about required media. The dict is called <code>MEDIA</code>.</p> <p>Example:</p> <pre><code>class ExamplePhone(PhoneFlavor):\n  # ... ommited other flavor specific code\n\n  MEDIA = {\n\n    \"background_image\": MediaDescriptor(\n      media_type=MediaType.IMAGE,\n      required=True,\n      label=\"Background Image\",\n      out_format=ImageFormat(\n        out_type=\"png\", colormode=\"RGB\", width=320, height=240\n      )\n    ),\n\n    \"ringtone\": MediaDescriptor(\n      media_type=MediaType.AUDIO,\n      required=False,\n      label=\"Ringtone\",\n      out_format=AudioFormat(\n        out_type=\"wav\", samplerate=44100, channels=1, bitdepth=8\n      ),\n      endpoint_filename=\"ringtone_xyz.wav\"\n    ),\n\n    \"firmware\": MediaDescriptor(\n      media_type=MediaType.RAW,\n      required=False,\n      label=\"Firmware\",\n      out_format=None\n    )\n\n  }\n</code></pre> <ul> <li> <p><code>MediaDescriptor</code> attributes:</p> <ul> <li><code>media_type</code>: one of <code>MediaType.AUDIO</code>, <code>MediaType.IMAGE</code>, <code>MediaType.RAW</code></li> <li><code>required</code>: <code>True</code> / <code>False</code></li> <li><code>label</code>: <code>str</code> used as form label in the frontend</li> <li><code>endpoint_filename</code>: optional <code>str</code> that is used to build the request endpoint (see below)</li> <li><code>out_format</code>: one of <code>ImageFormat</code>, <code>AudioFormat</code> or <code>None</code> depending on the <code>media_type</code></li> </ul> </li> <li> <p><code>ImageFormat</code> attributes:</p> <ul> <li><code>out_type</code>: one of <code>avif</code>, <code>bmp</code>, <code>gif</code>, <code>jpeg</code>, <code>png</code>, <code>tiff</code>, <code>webp</code></li> <li><code>samplerate</code>: <code>int</code> defaults to 44100</li> <li><code>channels</code>: <code>int</code> defaults to 2</li> <li><code>bitdepth</code>: <code>int</code> defaults to 16</li> </ul> </li> <li> <p><code>AudioFormat</code> attributes:</p> <ul> <li><code>out_type</code>: one of <code>gsm</code>, <code>wav</code>, <code>ogg</code>, <code>mp3</code>, <code>flac</code></li> <li><code>colormode</code>: one of <code>1</code> (monochrome), <code>L</code> (grayscale), <code>RGB</code> (default)</li> <li><code>width</code>: optional <code>int</code></li> <li><code>height</code>: optional <code>int</code><ul> <li>if only one of <code>width</code> or <code>height</code> is set, the aspect ratio is maintained</li> </ul> </li> </ul> </li> </ul>"},{"location":"features/media/#endpoints","title":"Endpoints","text":"<p>Media files that were assigned to an extension can be requested via two (three) methods:</p> <pre><code># By name (the key used in the MEDIA dict)\n# the response is in the specified audio/image format of the flavor\n   /api/v1/media/byextension/{extension}/{name}[.ext]\n\n# By endpoint_filename (as in the MediaDescriptor)\n# the response is in the specified audio/image format of the flavor\n   /api/v1/media/byextension/{extension}/{endpoint_filename}\n\n# Unconverted, static media file:\n# the response is in the default storage format\n   /api/v1/media/byid/{media_id}[.ext]\n</code></pre> <p>If the endpoint is marked with <code>[.ext]</code> you can optionally add any file-suffix you'd like to the request, this will be ignored.</p>"},{"location":"features/originate/","title":"Call Origination","text":"<p>Analagous to <code>WebSIP</code> this feature allows the user to comfortably dial an extension from the frontend. But in this case the call is originated from a physical telephone selectable from a drop-down menu.</p>"},{"location":"features/originate/#process","title":"Process","text":"<ol> <li>Click on an extension in the phonebook</li> <li>Select a phone to send the call to</li> <li>The selected phone will ring</li> <li>After pickup, the target phone will ring</li> <li>Profit!</li> </ol>"},{"location":"features/pages/","title":"Pages","text":"<p>You can create custom help / info or other markdown pages by putting markdown files called as you want your pages to be called in the <code>pages/</code> directory.</p> <p>If pages are enabled and \u00b5URU can find at least one markdown (.md) file in the <code>pages/</code> directory, a dropdown offering access to those pages will appear in the navbar.</p> <p>You can set the title of the dropdown button in the navbar by using the <code>PAGES_TITLE</code> configuration. All markdown files will be visible in the dropdown, for any user wether they're logged in or anonymous.</p>"},{"location":"features/websip/","title":"WebSIP","text":"<p>\u00b5URU has an experimental WebSIP feature, this makes it possible to call phones directly from a browser.</p> <p>It works by creating temporary extensions ad-hoc when someone wants to call an extension from the browser, the range for those extensions must be reserved so that no other extensions can be registers in this range.</p> <p>Once the extension was created signaling to the asterisk server is done via websockets and media is transported via webrtc (using SIP.js). At the end of the call the extension gets deleted again so that the range will hopefully never be exhausted (of course depending on the size of the range).</p> <p>To prevent problems with clients that do not unregister, \u00b5URU checks regulary for orphaned/unused extensions. To keep extensions alive a client must send at least every 3 minutes a keep alive request. All that is handled in the frontend.</p>"},{"location":"features/websip/#please-note","title":"Please note","text":"<p>All modern browsers require webrtc to be transported securely, so you need to use a reverse proxy with according certificates to enable secure transport for at least the asterisk server.</p>"},{"location":"features/websip/#configuration","title":"Configuration","text":"Key Description UURU_ENABLE_WEBSIP Enable websip (default is 1) UURU_WEBSIP_PUBLIC If true (default) yo don't need an account to use websip UURU_WEBSIP_WS_HOST External url where the asterisk websocket is reachable UURU_WEBSIP_EXTENSION_RANGE Tuple of start and end of the range e.G. [9900, 9999]"},{"location":"phone_types/SIP/","title":"SIP","text":"<p>The (second) most basic extension which simply creates a SIP extension which can be used to register softphones.</p>"},{"location":"phone_types/SIP/#prerequesites","title":"Prerequesites","text":"<p>Add <code>sip</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/SIP/#usage","title":"Usage","text":"<p>Create an extension with the SIP type and optionally select a codec. SIP phones and all phones based on them additionally support ringback tones.</p>"},{"location":"phone_types/callgroup/","title":"Callgroups","text":"<p>A group of numbers that will ring if the callgroup's extension is dialed.</p>"},{"location":"phone_types/callgroup/#prerequesites","title":"Prerequesites","text":"<p>Add <code>callgroup</code> to the list of enabled flavors in your config to enable the callgroup feature.</p>"},{"location":"phone_types/callgroup/#usage","title":"Usage","text":"<p>You can add callgroups as any other extension in the webapp, the participants of the callgroup are expressed as a comma-seperated list of the extensions.</p> <p>Normal users may only create callgroups with extensions they've created. Admin users can create callgroups from any extension.</p>"},{"location":"phone_types/conference/","title":"Conference","text":"<p>A phone conference can be used to gather several people in one room.</p>"},{"location":"phone_types/conference/#prerequesites","title":"Prerequesites","text":"<p>Add <code>conference</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/conference/#usage","title":"Usage","text":"<p>Create a new extension with the type <code>Conference</code>. People can now call the extension to join into the conference.</p>"},{"location":"phone_types/dummy/","title":"Dummy","text":"<p>An extension that isn't really an extension.</p>"},{"location":"phone_types/dummy/#prerequesites","title":"Prerequesites","text":"<p>Add <code>dummy</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/dummy/#usage","title":"Usage","text":"<p>You can create dummy extension and give them a name. They can be used to display dialplan entries you manually fumbled into the asterisk database.</p>"},{"location":"phone_types/grandstream/","title":"Grandstream","text":"<p>This flavor adds suport for Grandstream phones</p> <ul> <li><code>Grandstream WP810</code> (WiFi phone)</li> <li><code>Grandstream GXP2160</code></li> </ul>"},{"location":"phone_types/grandstream/#prerequesites","title":"Prerequesites","text":"<p>Add <code>grandstream</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/grandstream/#configuration","title":"Configuration","text":"<p>If you want to use automatic WiFi provisioning for the <code>WP810</code> you have to set some config keys:</p> Key Description UURU_GRANDSTREAM_WIFI_SSID SSID of your network UURU_GRANDSTREAM_WIFI_PASSWD Password of your network"},{"location":"phone_types/grandstream/#usage","title":"Usage","text":"<p>Create extensions with the type of your grandstream and enter the MAC address in the format <code>aa-bb-cc-00-11-22</code>.</p> <p>Info</p> <p>The letters must be lowercase and the bytes seperated by a hyphen!</p>"},{"location":"phone_types/innovaphone/","title":"Innovaphone","text":"<p>Support for</p> <ul> <li><code>Innovaphone IP241</code></li> <li><code>Innovaphone IP112</code></li> <li><code>Innovaphone IP200a</code></li> </ul>"},{"location":"phone_types/innovaphone/#prerequesites","title":"Prerequesites","text":"<p>Add <code>innovaphone</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/innovaphone/#dhcp","title":"DHCP","text":"<p>To use auto provisioning of Innovaphone devices add the following snippet to your <code>dnsmasq.conf</code>:</p> <pre><code>dhcp-option=vendor:1.3.6.1.4.1.6666,215,\"http://${UURU_WEB_HOST}/telephoning/innovaphone/update?mac=#m&amp;localip=#i\"\ndhcp-option=vendor:1.3.6.1.4.1.6666,216,1\n</code></pre> <p>_replace <code>${UURU_WEB_HOST}</code> accordingly</p>"},{"location":"phone_types/innovaphone/#usage","title":"Usage","text":"<p>Create extensions with the type of your innovaphone and enter the MAC address in the format <code>aa-bb-cc-00-11-22</code>.</p> <p>Info</p> <p>The letters must be lowercase and the bytes seperated by a hyphen!</p>"},{"location":"phone_types/iot/","title":"IoT","text":"<p>To enable autoprovisioning of IoT SIP devices you can exchange a secret for information about the extension. To do so you can create an extension with type <code>IoT</code> and set a secret, now you can request the details via http endpoint.</p>"},{"location":"phone_types/iot/#prerequesites","title":"Prerequesites","text":"<p>Add <code>iot</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/iot/#usage","title":"Usage","text":"<p>Create an extension with the IoT type and set a secret.</p>"},{"location":"phone_types/iot/#request","title":"Request","text":"<p>The url for this endpoint is <code>http[s]://{web host}/telephoning/iot/{your secret}</code>. You can optionally append a <code>?format={format}</code> to receive the data in <code>csv</code> or <code>xml</code> it defaults to <code>json</code>.</p>"},{"location":"phone_types/iot/#json","title":"json","text":"<pre><code>{\n  \"server\": \"192.168.42.254\",\n  \"transport\": \"udp\",\n  \"name\": \"Test IoT\",\n  \"location_name\": \"\",\n  \"lon\": 114324760,\n  \"password\": \"1895\",\n  \"public\": true,\n  \"type\": \"IoT\",\n  \"extension\": \"6562\",\n  \"lat\": 513765576,\n  \"token\": \"0199002940654\",\n  \"info\": \"\",\n  \"user_id\": \"2908dc6a-6658-4379-888b-c72f479221ae\",\n  \"extra_fields\": { \"secret\": \"some-secret-string\" }\n}\n</code></pre>"},{"location":"phone_types/iot/#csv","title":"csv","text":"<pre><code>server,transport,name,location_name,lon,password,public,type,extension,lat,token,info,user_id,extra_fields\n192.168.42.254,udp,Test IoT,,114324760,1895,True,IoT,6562,513765576,0199002940654,,2908dc6a-6658-4379-888b-c72f479221ae,{'secret': 'some-secret-string'}\n</code></pre>"},{"location":"phone_types/iot/#xml","title":"xml","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;root&gt;\n    &lt;server&gt;192.168.42.254&lt;/server&gt;\n    &lt;transport&gt;udp&lt;/transport&gt;\n    &lt;name&gt;Test IoT&lt;/name&gt;\n    &lt;location_name&gt;&lt;/location_name&gt;\n    &lt;lon&gt;114324760&lt;/lon&gt;\n    &lt;password&gt;1895&lt;/password&gt;\n    &lt;public&gt;true&lt;/public&gt;\n    &lt;type&gt;IoT&lt;/type&gt;\n    &lt;extension&gt;6562&lt;/extension&gt;\n    &lt;lat&gt;513765576&lt;/lat&gt;\n    &lt;token&gt;0199002940654&lt;/token&gt;\n    &lt;info&gt;&lt;/info&gt;\n    &lt;user_id&gt;2908dc6a-6658-4379-888b-c72f479221ae&lt;/user_id&gt;\n    &lt;extra_fields&gt;\n        &lt;secret&gt;some-secret-string&lt;/secret&gt;\n    &lt;/extra_fields&gt;\n&lt;/root&gt;\n</code></pre>"},{"location":"phone_types/iot/#further-considerations","title":"Further considerations","text":"<p>The IoT device should probably receive the endpoint (without the secret) via DHCP. If it's secure enough for you, you may use an unique identifier of your device like the MAC-Address as secret.</p>"},{"location":"phone_types/mitel_DECT/","title":"Mitel DECT","text":"<p>Register DECT phones using a Mitel OMM DECT setup.</p>"},{"location":"phone_types/mitel_DECT/#prerequesites","title":"Prerequesites","text":"<p>Add <code>mitel_dect</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/mitel_DECT/#configuration","title":"Configuration","text":"<p>Configure following config keys:</p> Key Description UURU_OMM_HOST Hostname or IP of the OMM UURU_OMM_PORT Port of the OMM UURU_OMM_USER Username of the OMM admin user UURU_OMM_PASSWORD Password of the OMM admin user UURU_OMM_VERIFY_CERT Should the https cert be verified"},{"location":"phone_types/mitel_DECT/#configure-the-omm","title":"Configure the OMM","text":"<p>Todo!</p>"},{"location":"phone_types/mitel_DECT/#usage","title":"Usage","text":"<p>\u00b5URU automatically enables reigstration for the RFPs, so you can directly connect your phone to the FP. Each new connected phone  gets a temporary extension assigned which cannot be used to dial  other users.</p> <p>After creating an extension with the <code>DECT</code> type you can dial the <code>token</code> displayed when you click on the key symbol in the list of your extension. If the token was valid, the dect phone will automatically be re-assigned to the actual extension and can now be used to dial other extensions.</p>"},{"location":"phone_types/snom/","title":"Grandstream","text":"<p>This flavor adds suport for some SNOM phones.</p> <ul> <li><code>SNOM 3xx</code></li> </ul>"},{"location":"phone_types/snom/#prerequesites","title":"Prerequesites","text":"<p>Add <code>snom</code> to the list of enabled flavors in your config.</p>"},{"location":"phone_types/snom/#dhcp","title":"DHCP","text":"<p>Set DHCP option 66 to <code>{UURU_HOST}/telephoning/snom/snom</code></p>"},{"location":"phone_types/snom/#usage","title":"Usage","text":"<p>Create extensions with the type of your SNOM and enter the MAC address in the format <code>aa-bb-cc-00-11-22</code>.</p> <p>Info</p> <p>The letters must be lowercase and the bytes seperated by a hyphen!</p>"}]}