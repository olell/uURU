config change PHONE SIG /prot SIP /gk-addr {{ settings.ASTERISK_HOST}} /h323 {{ extension.extension }} /auth-name {{ extension.extension }} /gk-pwd {{ extension.password }} /tones 0 /coder G711A,20,
{% if extension.get_assigned_media("background_image") %}
config change PHONE APP /bg-image http://{{ settings.WEB_HOST }}/api/v1/media/byextension/{{ extension.extension }}/background_image.png
{% endif %}
{# fw <= 11 puts LDAP config inside PHONE/USER-UI #}
{# fw >= 12 puts LDAP config inside PHONE/CONF-UI #}
{# set both to make everyone happy #}
{% for menu in ['USER-UI', 'CONF-UI'] %}
mod cmd PHONE/{{ menu }} reg-edit-dir /cmd reg-edit-dir /id 0 /ldap.1.enable on /ldap.3.enable on /ldap.3.addr {{ settings.LDAP_PUBLIC_HOST }} /ldap.3.port 389 /ldap.3.dn {{ settings.LDAP_PUBLIC_BIND_USER }} /ldap.3.pw {{ settings.LDAP_PUBLIC_BIND_PASSWORD }} /ldap.3.pw* {{ settings.LDAP_PUBLIC_BIND_PASSWORD }} /ldap.3.base {{ settings.LDAP_BASE_DN }} /ldap.3.mode basic /ldap.3.obj /ldap.3.attr sn /ldap.3.phone telephoneNumber /ldap.3.mail /ldap.3.detail l /ldap.3.meta-txt /ldap.3.meta-num /ldap.3.hold /loc.cc /loc.ac /loc.ntp /loc.itp /loc.col /loc.pbx /loc.len /op OK /userid admin
{% endfor %}
config change SNMP0 /community public /v3auth 0 /v3crypt 0 /enable /enablev1 /trap-delay 90
config change NTP0 /addr pool.ntp.org /interval 60 /offset CET-1CEST-2,M3.5.0/2,M10.5.0/3
config change TELNET0 /port 23
config write
config activate